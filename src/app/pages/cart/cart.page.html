<ion-content class="ion-padding page-with-header">

  @if (cart.cart().length > 0) {

    @for (item of cart.cart(); track item.product.id) {

      <ion-item>
        <ion-thumbnail slot="start">
          <img [src]="item.product.thumbnail">
        </ion-thumbnail>

        <ion-label>
          <h2>{{ item.product.title }}</h2>
          <p>{{ item.product.price }} €</p>
          <p>Cantidad: {{ item.quantity }}</p>
        </ion-label>

        <ion-buttons slot="end">
          <ion-button fill="clear"
            (click)="cart.decreaseQuantity(item.product.id)">
            <ion-icon name="remove-outline"></ion-icon>
          </ion-button>

          <ion-button fill="clear"
            (click)="cart.addToCart(item.product)">
            <ion-icon name="add-outline"></ion-icon>
          </ion-button>

          <ion-button fill="clear"
            color="danger"
            (click)="cart.removeFromCart(item.product.id)">
            <ion-icon name="trash-outline"></ion-icon>
          </ion-button>
        </ion-buttons>
      </ion-item>

    }

    <ion-item lines="none">
      <ion-label>
        <h2>Total: {{ cart.totalPrice() | currency:'EUR' }}</h2>
        <p>Total productos: {{ cart.totalItems() }}</p>
      </ion-label>
    </ion-item>

    <ion-button
      expand="block"
      color="success"
      [disabled]="loadingCheckout"
      (click)="doCheckout()">

      @if (loadingCheckout) {
        <ion-spinner name="crescent"></ion-spinner>
      } @else {
        Comprar ahora
      }
    </ion-button>


    <ion-button expand="block" color="danger"
      (click)="cart.clearCart()">
      Vaciar carrito
    </ion-button>

  } @else {
    <p>El carrito está vacío.</p>
  }

</ion-content>
